# ü§ñ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è AI-–∞–≥–µ–Ω—Ç–æ–≤

## 1. –ß—Ç–æ –º—ã –¥–µ–ª–∞–µ–º
Telegram-–±–æ—Ç –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ —Ç–∞–º–æ–∂–µ–Ω–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π –∏ –ª–æ–≥–∏—Å—Ç–∏–∫–∏ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ —Ç–æ–≤–∞—Ä–æ–≤ –∏–∑ –ö–∏—Ç–∞—è –≤ –†–æ—Å—Å–∏—é.
–ë–æ—Ç –ø–æ–º–æ–≥–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º:
- –ù–∞–π—Ç–∏ –∫–æ–¥ –¢–ù –í–≠–î –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é —Ç–æ–≤–∞—Ä–∞ (—á–µ—Ä–µ–∑ AI –∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω—É—é –±–∞–∑—É)
- –†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Ç–∞–º–æ–∂–µ–Ω–Ω—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å, –ø–æ—à–ª–∏–Ω—É, –ù–î–° –∏ —Å–±–æ—Ä—ã
- –°—Ä–∞–≤–Ω–∏—Ç—å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –∏–º–ø–æ—Ä—Ç —Å ¬´–∫–∞—Ä–≥–æ¬ª
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–¢–† –¢–°)

---

## 2. –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
**–¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è:** –ò–º–ø–æ—Ä—Ç—ë—Ä—ã, –ª–æ–≥–∏—Å—Ç—ã, –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª–∏.
**–ë–∏–∑–Ω–µ—Å-—Ü–µ–ª—å:** –ë—ã—Å—Ç—Ä—ã–π —Ä–∞—Å—á—ë—Ç ¬´–ø–æ–¥ –∫–ª—é—á¬ª –±–µ–∑ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ –±—Ä–æ–∫–µ—Ä—É.
**–ö–ª—é—á–µ–≤–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å:** –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–∏—Å–∫ (AI + –±–∞–∑–∞) –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

---

## 3. –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è |
|-----------|------------|
| –Ø–∑—ã–∫ | Python 3.11+ |
| –§—Ä–µ–π–º–≤–æ—Ä–∫ –±–æ—Ç–∞ | aiogram 3.x |
| –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö | SQLite (`data.db`) |
| AI-–ø—Ä–æ–≤–∞–π–¥–µ—Ä | OpenAI API (—á–µ—Ä–µ–∑ OpenRouter/NeuroAPI) |
| –ú–æ–¥–µ–ª–∏ | GPT-4o, DeepSeek |
| –î–µ–ø–ª–æ–π | –õ–æ–∫–∞–ª—å–Ω–æ / VPS |

**–ö–ª—é—á–µ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** `aiogram`, `openai`, `pandas`, `sqlite3`

---

## 4. –ü—Ä–æ–¥–µ–ª–∞–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞

### Phase 1: –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä ‚úÖ
- –§–æ—Ä–º—É–ª–∞: `–¢–∞–º.—Å—Ç–æ–∏–º–æ—Å—Ç—å = –ò–Ω–≤–æ–π—Å (CNY‚ÜíRUB) + –î–æ—Å—Ç–∞–≤–∫–∞ (USD‚ÜíRUB)`
- –ü–æ—à–ª–∏–Ω–∞: `%` –æ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∏–ª–∏ `‚Ç¨/–∫–≥ * –≤–µ—Å –Ω–µ—Ç—Ç–æ`
- –ù–î–°: `20%` –æ—Ç `(–¢–∞–º.—Å—Ç–æ–∏–º–æ—Å—Ç—å + –ü–æ—à–ª–∏–Ω–∞)`
- –¢–∞–º–æ–∂–µ–Ω–Ω—ã–π —Å–±–æ—Ä: –ø–æ —Ç–∞–±–ª–∏—Ü–µ (775‚ÇΩ ‚Äî 30,000‚ÇΩ)

### Phase 2: –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è ‚úÖ
- **–ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–∏—Å–∫:**
  1. –°–Ω–∞—á–∞–ª–∞ –∏—â–µ–º –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π –±–∞–∑–µ (`certification_rules`, ~1700 –∑–∞–ø–∏—Å–µ–π)
  2. –ï—Å–ª–∏ –Ω–µ—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è (–º–∏–Ω–∏–º—É–º 4 –∑–Ω–∞–∫–∞ –∫–æ–¥–∞) ‚Üí AI-–∞–Ω–∞–ª–∏–∑
- **–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö:** –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ CSV —Å data.gov.ru (CP1251)
- **–°–∫—Ä–∏–ø—Ç –∏–º–ø–æ—Ä—Ç–∞:** `app/scripts/import_certification.py`

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –±–∞–≥–∏
- –õ–æ–∂–Ω—ã–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –ø–æ —à–∏—Ä–æ–∫–∏–º –≥—Ä—É–ø–ø–∞–º (–∫–æ–¥ `85` ‚Üí ¬´–†–µ–∞–∫—Ç–æ—Ä—ã¬ª)
- –û—à–∏–±–∫–∏ —Ä–∞–∑–±–∏–µ–Ω–∏—è –∫–æ–¥–æ–≤ –≤ CSV (—Å–∫–ª–µ–∏–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª—ã)

---

## 5. –ö–∞–∫ –∏ –∫—É–¥–∞ –∫–æ–º–º–∏—Ç–∏—Ç—å

**–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:** `https://github.com/Alfirs/crawler`
**–í–µ—Ç–∫–∞:** `master`

### Workflow
```bash
# 1. –í–Ω–µ—Å—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è
# 2. –î–æ–±–∞–≤–∏—Ç—å —Ñ–∞–π–ª—ã
git add <files>

# 3. –ö–æ–º–º–∏—Ç —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º
git commit -m "feat(module): –æ–ø–∏—Å–∞–Ω–∏–µ"  # –ù–æ–≤–∞—è —Ñ–∏—á–∞
git commit -m "fix(module): –æ–ø–∏—Å–∞–Ω–∏–µ"   # –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
git commit -m "docs: –æ–ø–∏—Å–∞–Ω–∏–µ"          # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

# 4. –ü—É—à
git push origin master
```

### –ß—Ç–æ –ù–ï –∫–æ–º–º–∏—Ç–∏—Ç—å
- `.env` (—Å–µ–∫—Ä–µ—Ç—ã)
- `data.db` (–±–∏–Ω–∞—Ä–Ω–∞—è –±–∞–∑–∞)
- `__pycache__/`
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã (`diagnose_*.py`, `check_*.py`)

---

## 6. –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞

```
/start
   ‚îÇ
   ‚ñº
[–í—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞]
   ‚îú‚îÄ‚îÄ "–í–≤–µ—Å—Ç–∏ –∫–æ–¥ –¢–ù –í–≠–î" ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
   ‚îú‚îÄ‚îÄ "–í–≤–µ—Å—Ç–∏ —Å—Ç–∞–≤–∫—É –ø–æ—à–ª–∏–Ω—ã" ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
   ‚îî‚îÄ‚îÄ "–ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å —Å –ø–æ–¥–±–æ—Ä–æ–º" ‚îÄ‚îÄ‚ñ∫ [AI Search] ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
                                                       ‚ñº
                                            [–í–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö]
                                               ‚îÇ
   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
   ‚ñº
[node_enter_price] ‚îÄ‚îÄ‚ñ∫ –ò–Ω–≤–æ–π—Å (CNY)
   ‚ñº
[node_enter_delivery_cost] ‚îÄ‚îÄ‚ñ∫ –î–æ—Å—Ç–∞–≤–∫–∞ (USD)
   ‚ñº
[node_enter_weight_gross] ‚îÄ‚îÄ‚ñ∫ –ë—Ä—É—Ç—Ç–æ (–∫–≥)
   ‚ñº
[node_enter_weight_net] ‚îÄ‚îÄ‚ñ∫ –ù–µ—Ç—Ç–æ (–∫–≥)
   ‚ñº
[node_enter_length/width/height] ‚îÄ‚îÄ‚ñ∫ –ì–∞–±–∞—Ä–∏—Ç—ã
   ‚ñº
[node_calc_result] ‚îÄ‚îÄ‚ñ∫ –†–∞—Å—á—ë—Ç + –°—Ä–∞–≤–Ω–µ–Ω–∏–µ
   ‚îÇ
   ‚îú‚îÄ‚îÄ [–ö–Ω–æ–ø–∫–∞: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é]
   ‚îÇ       ‚îÇ
   ‚îÇ       ‚ñº
   ‚îÇ   [check_certification()]
   ‚îÇ       ‚îú‚îÄ‚îÄ DB Match (4+ digits) ‚îÄ‚îÄ‚ñ∫ "‚úÖ –ù–∞–π–¥–µ–Ω–æ –≤ –ø–µ—Ä–µ—á–Ω—è—Ö"
   ‚îÇ       ‚îî‚îÄ‚îÄ No Match ‚îÄ‚îÄ‚ñ∫ AI ‚îÄ‚îÄ‚ñ∫ "‚ö†Ô∏è –°–ø—Ä–∞–≤–æ—á–Ω–æ (AI)"
   ‚îÇ
   ‚îî‚îÄ‚îÄ [–ö–Ω–æ–ø–∫–∞: –í –Ω–∞—á–∞–ª–æ] ‚îÄ‚îÄ‚ñ∫ /start
```

### –ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã –ª–æ–≥–∏–∫–∏
| –§–∞–π–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------|------------|
| `app/flow/engine.py` | FSM-–º–∞—à–∏–Ω–∞, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ |
| `app/domain/calculator.py` | –§–æ—Ä–º—É–ª—ã —Ä–∞—Å—á—ë—Ç–∞ |
| `app/domain/search.py` | –ü–æ–∏—Å–∫ –∫–æ–¥–æ–≤ + —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è |
| `app/storage/db.py` | –†–∞–±–æ—Ç–∞ —Å SQLite |
| `input/bot_map.json` | –ö–∞—Ä—Ç–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ |

---

## 7. –û—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

| –î–æ–∫—É–º–µ–Ω—Ç | –ü—É—Ç—å | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|------|----------|
| –ò–º–ø–æ—Ä—Ç –¢–ù –í–≠–î | `docs/TNVED_IMPORT.md` | –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö, —Ñ–æ—Ä–º–∞—Ç—ã |
| –ü–ª–∞–Ω –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ | `brain/.../implementation_plan.md` | –§–æ—Ä–º—É–ª—ã, —Ç–∞–±–ª–∏—Ü—ã —Å–±–æ—Ä–æ–≤ |
| Walkthrough | `brain/.../walkthrough.md` | –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ, –∫–∞–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å |
| –≠—Ç–æ—Ç —Ñ–∞–π–ª | `AGENTS.md` | –ö–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è AI-–∞–≥–µ–Ω—Ç–æ–≤ |

### –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
```bash
# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
python -m app.main

# –ò–º–ø–æ—Ä—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–Ω—É–∂–Ω—ã CSV –≤ –∫–æ—Ä–Ω–µ)
python app/scripts/import_certification.py

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –±–∞–∑—ã
sqlite3 data.db ".schema"
```

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –Ω—é–∞–Ω—Å—ã

1. **–ö—É—Ä—Å—ã –≤–∞–ª—é—Ç** –±–µ—Ä—É—Ç—Å—è –∏–∑ API –¶–ë/–≤–Ω–µ—à–Ω–µ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ (`rates_provider.py`).
2. **AI-–∫–ª—é—á** —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ `.env` –∫–∞–∫ `OPENAI_API_KEY`.
3. **–ë–∞–∑–∞ `certification_rules`** –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –∏–∑ CSV —Å data.gov.ru (–∫–æ–¥–∏—Ä–æ–≤–∫–∞ CP1251).
4. **–ü–æ–∏—Å–∫ –∫–æ–¥–æ–≤ –¢–ù –í–≠–î** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ—Ç–æ–¥–æ–≤: –ª–æ–∫–∞–ª—å–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω-–º–∞—Ç—á–∏–Ω–≥, –≤–µ–∫—Ç–æ—Ä–Ω–∞—è –ë–î (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞), LLM.
5. **–ü–æ—Ä–æ–≥ —Ç–æ—á–Ω–æ—Å—Ç–∏**: –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç DB-—Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ >= 4 –∑–Ω–∞–∫–æ–≤ –∫–æ–¥–∞.

---

*–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: 2026-02-07*
